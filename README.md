# 🎤 ボーカルレンジアナライザー

> 自分の歌声を分析して、カラオケで気持ちよく歌おう！

![プロダクトイメージ](https://kc3.me/cms/wp-content/uploads/2026/02/444e7120d5cdd74aa75f7a94bf8821a5-scaled.png)

## チーム名

チーム11 ボーカルレンジ研究所

---

## 背景・課題・解決されること

### 背景

カラオケは日本の文化として深く根付いていますが、多くのユーザーが「自分に合う曲選び」で悩んでいます。

### 課題

- **自分の声域を客観的に知らない** — どの音域まで出せるのか、正確に把握している人は少ない
- **曲選びで失敗する** — 「歌ってみたらサビが高すぎた…」という経験は誰もがしたことがある
- **曲の音域情報がバラバラ** — ネット上に点在する情報は信頼性がまちまち

### 解決内容

AIを活用した**リアルタイム声域分析**と、**3,900曲以上の音域データベース**のマッチングで、最適な曲選びを実現します。

---

# 1. プロダクト説明

## 主な特徴

### 1. AI声域分析

マイクで数秒歌うだけで、AIがあなたの地声・裏声の音域を自動判定します。

### 2. カラオケ音源にも対応

カラオケで録音した音源をアップロードすると、AIが**BGMからボーカルだけを分離**してから分析します。

### 3. 3,900曲の音域データベース

voice-key.newsから収集した3,900曲・260アーティストの音域情報で、自分の声域に合う曲をすぐに検索できます。

---

# 2. 機能一覧

| #   | 機能                    | 説明                                                                          |
| --- | ----------------------- | ----------------------------------------------------------------------------- |
| 1   | 🎤 マイク録音           | ブラウザからマイクで録音。リアルタイム波形表示で録音状況を確認できる          |
| 2   | 🎵 カラオケ録音分析     | カラオケで録音して判定。Demucs（Meta AI）でボーカルを自動分離してから声域分析 |
| 3   | 📁 ファイルアップロード | アカペラやカラオケで歌った録音ファイルを直接アップロードして分析              |
| 4   | 🔍 地声/裏声の自動分類  | 機械学習を使って、地声と裏声を自動判別。比率も表示                            |
| 5   | 🎶 楽曲検索             | 約5000曲・850アーティストの音域データベースから、自分の声域に合う曲を検索     |
| 6   | 📋 アーティスト別一覧   | アーティストごとの楽曲一覧表示。ページネーション対応                          |
| 7   | 💾 分析履歴管理         | 過去の分析結果を保存・参照（ユーザー認証後）                                  |
| 8   | ❤️ お気に入り登録       | 推奨楽曲をお気に入りに保存（ユーザー認証後）                                  |
| 9   | 👤 ユーザープロフィール | 声域情報を自動保存・管理（ユーザー認証後）                                    |

---

# 3. 使い方・利用フロー

## 基本的な使用フロー

```
Step 1: 声を録音する
┌──────────────────────────────────┐
│  🎤 マイクで録音                   │  ← その場でアカペラで数秒歌う
│  🎵 カラオケ音源をアップロード      │  ← カラオケ店で録ったBGM付き音源
│  📁 ファイルをアップロード          │  ← 手元にある音声ファイル
└──────────────────────────────────┘
              ↓
Step 2: AIが声域を分析
┌──────────────────────────────────┐
│  分析中...                         │  ← 自動処理
│  （ノイズ除去→ボーカル分離→分析）  │
└──────────────────────────────────┘
              ↓
Step 3: 分析結果を確認
┌──────────────────────────────────┐
│  地声: mid1C ～ hiA               │
│  裏声: hiA ～ hiD                 │
│  地声率: 72% / 裏声率: 28%        │
└──────────────────────────────────┘
              ↓
Step 4: ぴったりの曲を検索
┌──────────────────────────────────┐
│  🎶 あなたの声域に合う曲一覧      │
│  アーティスト / 曲名 / 音域        │
│  💾 履歴管理 ❤️ お気に入り登録     │
└──────────────────────────────────┘
```

## 分析結果の表示例

| 項目       | 説明                             | 例         |
| ---------- | -------------------------------- | ---------- |
| 地声最低音 | あなたが出せる最も低い音（地声） | mid1C (C3) |
| 地声最高音 | あなたが出せる最も高い音（地声） | hiA (A4)   |
| 裏声最高音 | あなたが出せる最も高い音（裏声） | hiD (D5)   |
| 地声率     | 音声全体に占める地声の割合       | 72%        |
| 裏声率     | 音声全体に占める裏声の割合       | 28%        |

---

# 4. 技術面でのこだわり

## 技術スタック

| レイヤー           | 技術                  | 用途                               |
| ------------------ | --------------------- | ---------------------------------- |
| **フロントエンド** | React 19 / TypeScript | UIフレームワーク                   |
|                    | Tailwind CSS          | スタイリング（モバイルファースト） |
| **バックエンド**   | FastAPI (Python)      | REST APIサーバー                   |
|                    | Supabase              | ユーザー認証・データベース         |
| **音声処理**       | CREPE                 | ピッチ検出・音高抽出               |
|                    | librosa               | スペクトル分析・周波数解析         |
|                    | demucs                | ボーカル分離（Meta AI）            |
|                    | noisereduce           | バックグラウンドノイズ除去         |
| **データ管理**     | SQLite / PostgreSQL   | 楽曲情報DB (3,900曲)               |
| **音声処理ML**     | torch / torchaudio    | PyTorchベースの計算                |
| **ユーティリティ** | librosa, scipy        | 信号処理                           |

## アーキテクチャ概要

```
┌─────────────────────────────────────┐
│   ブラウザ (React 19 + TypeScript)   │
│  ┌──────────────────────────────┐   │
│  │ 🎤 マイク録音 / 📁 ファイルUL  │   │
│  │ 🎶 楽曲検索 / ❤️ お気に入り   │   │
│  └──────────────────────────────┘   │
└─────────────┬───────────────────────┘
              │ HTTPS REST API
              ↓
┌─────────────────────────────────────┐
│   FastAPI バックエンドサーバー      │
│  ┌──────────────────────────────┐   │
│  │ 🔐 認証 (Supabase JWT)        │   │
│  │ 📊 音声分析 エンドポイント     │   │
│  │ 🎵 楽曲検索 API               │   │
│  │ 👤 プロフィール管理           │   │
│  └──────────────────────────────┘   │
└─────────┬───────────────────────────┘
          ├─ 音声処理パイプライン
          │  ┌────────────────────┐
          │  │ ノイズ除去         │
          │  │    ↓              │
          │  │ ボーカル分離       │
          │  │ (Demucs)          │
          │  │    ↓              │
          │  │ ピッチ検出        │
          │  │ (CREPE)           │
          │  │    ↓              │
          │  │ スペクトル分析     │
          │  │    ↓              │
          │  │ 地声/裏声分類      │
          │  └────────────────────┘
          │
          └─ データベース
             ├─ Supabase (認証・ユーザー)
             └─ SQLite (楽曲情報)
                 3,900曲 / 260アーティスト
```

## 音声分析の工夫

### CREPEピッチ検出の精度調整

ピッチ検出は声域分析の精度を大きく左右するため、多段階の調整を実装しています。

**段階的フォールバック戦略:**

- 1回目: `model=small, decoder=viterbi, confidence≥0.5`
- 2回目: `model=small, decoder=weighted_argmax, confidence≥0.3`
- 3回目: `model=tiny, decoder=weighted_argmax, confidence≥0.01`

ノイズが多い環境でも結果を返せるよう設計されています。

**2段階オクターブエラー補正:**

- 中央値ベース補正 — 地声/裏声判定に使用
- スペクトル分析ベース補正 — 正確な最高音特定に使用

### 地声/裏声の自動分類

6つのスペクトル指標によるスコアリングで判定：

| 指標             | 地声/裏声の区別根拠  |
| ---------------- | -------------------- |
| H1-H2差          | 裏声は第1倍音が卓越  |
| 有効倍音数       | 地声は倍音が豊富     |
| 倍音減衰スロープ | 裏声は急速に減衰     |
| HNR              | 裏声は息漏れが多い   |
| スペクトル重心比 | 地声は重心が高い     |
| 音域補正         | 高音域は裏声の可能性 |

### Demucsによるボーカル分離

カラオケ音源のBGM除去にMeta AIの Demucs モデルを使用：

- **アカペラ** — 16kHzモノラル変換で十分
- **カラオケ** — 44.1kHzステレオで変換し、分離精度を確保

## 音域データベース

[voice-key.news](https://voice-key.news/) からの自動スクレイピング実装：

- **3,900曲** / **260アーティスト**
- 地声最低音・最高音・裏声最高音をカラオケ表記で保存
- アーティスト検索・ページネーション対応API

---

# 5. UI/UX 面でのこだわり

## モバイルファーストデザイン

カラオケ店での利用を想定し、スマートフォン操作を最優先に設計：

- **BottomNav** — スマホでは画面下部にナビゲーション配置、片手操作を実現
- **Header切替** — PC表示ではヘッダーナビに自動切替
- **レスポンシブレイアウト** — Tailwind CSS で画面サイズに応じたUI最適化

## リアルタイム波形表示

録音中に音声波形をリアルタイム表示。「ちゃんと録れているか」を視覚的にフィードバックしてユーザーの不安を解消。

## 3つの入力モード

ユーザーの状況に合わせた3つの録音方法：

| モード                      | 利用シーン                          |
| --------------------------- | ----------------------------------- |
| 🎤 マイク録音               | その場でアカペラで歌って分析        |
| 🎵 カラオケ音源アップロード | カラオケ店で録ったBGM付き音源を分析 |
| 📁 ファイルアップロード     | 手元にある音声ファイルを分析        |

## ユーザー認証機能

Supabase認証により：

- 分析履歴を自動保存
- 声域情報を管理・追跡
- お気に入り曲を登録
- マイページでプロフィール管理

---

# 6. セットアップ・実行方法

## 前提条件

- Node.js 18+ (フロントエンド)
- Python 3.8+ (バックエンド)
- pip & venv (Python依存管理)

## バックエンド セットアップ

```bash
cd backend
python -m venv venv
source venv/bin/activate  # or `venv\Scripts\activate` on Windows
pip install -r requirements.txt
```

## フロントエンド セットアップ

```bash
cd frontend
npm install
```

## 環境変数設定

バックエンド (`backend/.env`):

```
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_key
```

フロントエンド (`frontend/.env`):

```
REACT_APP_API_URL=http://127.0.0.1:8000
```

## 実行

**バックエンド:**

```bash
cd backend
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

**フロントエンド:**

```bash
cd frontend
npm start
```

アプリは `http://localhost:3000` で起動します。

---

# 7. 注力したポイント

## アイデア面

- **AIと音域データの組み合わせ** — 単なる録音アプリではなく、楽曲マッチングまでを一体化
- **3つの入力モード** — アカペラ/カラオケ/ファイルと、ユーザーの状況に合わせた柔軟性
- **カラオケ文化への深い理解** — 日本の文化的背景から生まれたプロダクト

## デザイン面

- **モバイルファースト** — スマートフォンでの片手操作を最優先に実装
- **波形表示** — 視覚的フィードバックでユーザーの不安解消
- **シンプルで直感的なUI** — 複雑な音声分析を隠蔽し、結果に集中

## 技術面

- **CREPEの多段調整** — ノイズ環境でも動作する堅牢なピッチ検出
- **6指標スペクトル分析** — 科学的根拠に基づいた地声/裏声判定
- **Demucsボーカル分離** — Meta AIの最新技術を活用してカラオケ音源対応
- **Supabase統合** — 認証・DBを統一し、スケーラブルな設計を実現

---

# 8. 今後の展望

- **🤖 声域マッチングレコメンド** — 分析結果に基づいて「あなたにおすすめの曲」を自動提案
- **📈 声域トラッキング** — 過去の分析結果を保存し、声域の変化を時系列で追跡
- **🎤 歌唱力レーダーチャート** — 音域の広さ・安定性・地声/裏声バランスなどを多角的に可視化
- **🌐 音域データベース拡充** — +2,000曲を追加予定
- **🎵 DAM・JOYSOUNDの連携** — カラオケ機器との直接連携
- **📱 ネイティブアプリ化** — iOS/Android 対応

---

# 9. ライセンス

MIT License

---

**開発：チーム11 ボーカルレンジ研究所**

お問い合わせや機能リクエストは、GitHub Issues からお願いします。
